<!doctype html>
<html lang="uz">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>MathCenter — Starter</title>
  <style>
    /* Modal uchun zarur minimal klasslar */
    .hidden { display: none !important; }
    .modal  { position: fixed; inset: 0; background: rgba(0,0,0,.32); z-index: 1000; padding: 10px; }
    /* Sahnadagi oddiy UI */
    body { font-family: system-ui, -apple-system, Segoe UI, Roboto, Arial, sans-serif; margin: 0; }
    header { position: sticky; top: 0; background: #0ea5e9; color: #fff; padding: 12px 16px; font-weight: 600; }
    main { padding: 16px; }
    .card { border: 1px solid #e5e7eb; border-radius: 12px; padding: 14px; }
    .row { display:flex; gap:8px; align-items:center; flex-wrap:wrap; }
    .btn { border: 1px solid #0ea5e9; background:#0ea5e9; color:#fff; padding:10px 14px; border-radius:10px; cursor:pointer; }
    .btn.ghost { background:#fff; color:#0ea5e9; }
  </style>
</head>
<body>
  <header>MathCenter</header>

  <main>
    <div class="card">
      <div class="row">
        <strong>Holat:</strong>
        <span id="state">Tekshirilmoqda…</span>
      </div>
      <div class="row" style="margin-top:8px">
        <!-- Ixtiyoriy: qo'shimcha kirish/chiqish tugmalari.
             common.js dagi bindGoogleButtons() quyidagi selektorlarni avtomatik bog'laydi:
             #googleLoginBtn, .google-signin, [data-action="signin-google"] :contentReference[oaicite:1]{index=1} -->
        <button class="btn google-signin">Google bilan kirish</button>
        <button class="btn ghost" data-action="signout">Chiqish</button>
      </div>
    </div>
  </main>

  <!-- Muhim: common.js modul sifatida faqat index.html da ulansin -->
  <script type="module">
    import { attachAuthUI, initUX } from './common.js';

    // Foydalanuvchi chiqib turganda modalni avtomatik ochish uchun requireSignIn=true
    // (onAuthStateChanged ichida showAuthModal() chaqiriladi) :contentReference[oaicite:2]{index=2}
    window.addEventListener('DOMContentLoaded', () => {
      attachAuthUI({ requireSignIn: true });
      initUX();

      // mc:user-ready hodisasi kelganda UI ni yangilaymiz :contentReference[oaicite:3]{index=3}
      document.addEventListener('mc:user-ready', (e) => {
        const { user, profile } = e.detail || {};
        const s = document.getElementById('state');
        s.textContent = user ? (`Kirdingiz: ${profile?.firstName || ''} ${profile?.lastName || ''}`.trim()) : 'Chiqib turibsiz';
      });
    });
  </script>
</body>
</html>
